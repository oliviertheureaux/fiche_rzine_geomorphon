---
title: "Geomorphons pour l'analyse des formes du terrain"
subtitle: "Analyse des formes du relief par l'algorithme *Geomorphon* : étude de trois milieux différents"
date: "2022-07-5"
author: 
 - name: Olivier Theureaux
   affiliation: UMR LADYSS, CNRS
image: "featured2.png"
output: 
  rzine::readrzine:
    highlight: kate
    number_sections: true
csl: Rzine_citation.csl
bibliography: biblio.bib
nocite : |
  @*
link_citations: true

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Photographie : D. Birre, 2021

R Markdown see <http://rmarkdown.rstudio.com>

# Importance du relief dans la compréhension des processus physiques

Définition d'un bassin versant
Le BV est "un espace géographique alimentant un cours d'eau et drainé par lui. Il a pour axe le cours d'eau principal et pour limite la ligne de partage des eaux le séparant des bassins versants adjacents" (George, 1970)


Une meilleure connaissance du relief d'un bassin versant permet de mieux comprendre les processus d'écoulement, de mieux comprendre la circulation des eaux, d'identifier les zones d'accumulation et les zones de transfert des eaux.


# L'analyse du relief par le traitement *Geomorphon*

## Présentation du traitement *Geomorphon*

L’algorithme ***Geomorphons***, pour *geomorphologic phonotypes*, est une méthode qui identifie les formes du paysage en utilisant un schéma de reconnaissance développé par Jasiewicz et Stepinski (2012). 

L’algorithme des géomorphons permet d’étudier les formes du relief. Nous avons décidé d’utiliser les géomorphons, qui est une méthode relativement récente (2012) comparée aux autres méthodes de classification automatique du relief basées sur la valeur de la pente et de la courbure du terrain (Dikau, 1991 ; Wood, 1996). Ces méthodes sont efficaces pour traiter de petits rasters mais fonctionnent moins bien dans le cadre de rasters à plusieurs millions de pixels : les calculs sont alors trop complexes et demandent trop de ressources pour identifier avec suffisamment de précision l’ensemble des formes du terrain. Un des premiers usages de l’algorithme fut la création de la carte géomorphologique de la Pologne (Jasiewicz and Stepinski, 2013). Il a été aussi utilisé pour décrire le relief du Monténégro (Frankl *et al*., 2016). Puis l'algorithme a été utilisé pour identifier certaines formes spécifiques du paysage, comme des drumlins (Sarasan *et al*., 2018) ou des surfaces plates (Veselsky *et al*., 2015). Bandura (2016) l’a aussi utilisé pour identifier et délimiter des sommets dans les montagnes slovaques. Cette méthode a également été utilisée pour détecter des objets à une échelle plus fine : des formes à la surface d’un glacier (Gawrysiak, 2020), des traces de barrages organisés par des castors (Swift, 2021), ou bien encore la détection de formes fluviales côtières (Gioia, 2021).

Les géomorphons sont déterminés par une méthode de classification semi-automatique du modèle numérique de terrain (MNT). Cette méthode ne prend pas en compte les valeurs des cellules voisines mais s’inspire du principe de "ligne de mire". La méthode est flexible et s’adapte à différents terrains car le critère de la “ligne de mire” est plus souple que le critère de la “fenêtre fixe” que l’on trouve dans les autres méthodes de classification. Elle adapte la distance à prendre en compte selon la notion de « *terrain openess* ». Il s’agit de calculer le rapport entre ce qui est appelé l’angle au zénith (Φ : *zenith angle*) et l’angle au nadir (Ψ : *nadir angle*) au sein d’un rayon de recherche défini par l’utilisateur (*lookup distance*). Le rayon est égal à x fois la largeur d’un pixel. Par exemple, choisir une *lookup distance* de 10 pour un MNT d’une résolution de 5 mètres cela revient à choisir une *lookup distance* de 50 mètres. Aussi, le paramètre “*threshold angle*” permet de définir le niveau minimum de planéité souhaité permettant de gommer les aspérités microtopographiques. 

*Geomorphons* est disponible dans l’application SAGA (Système pour les Analyses Géoscientifiques Automatisées) que nous appelons *via* le package *qgisproceess*.


```
dem_geomorphons = qgis_run_algorithm("saga:geomorphons",
                                       DEM = DEM,
                                       THRESHOLD = 1, # fixe le seuil de planéité
                                       RADIUS = 60, # fixe le rayon de recherche
                                       METHOD = 1, #
                                       GEOMORPHONS = paste("nom", ".tif"))

```


## Les 10 formes du paysage obtenues par le traitement

Geomorphons compare chaque cellule du MNT aux huit valeurs des voisins visibles les plus lointains. Les altitudes équivalentes à la valeur de la cellule centrale sont représentées par un point vert, celles plus basses en bleu et celles plus hautes en rouge.

<figure class="center">
  <img src="figures/geomorphon_8valeurs.png" width="700">
  <figcaption style="font-size:13px;">*Analyse diachronique de la parcelle 693. A : Orthophotographie actuelle (2016) ; B :
Raster historique : classification pixel forêt / pixel non forêt en 1955 ; C : Raster actuel reclassifié :
classification pixel forêt / pixel non forêt en 2015 ; D : Nouveau raster résultant de la somme du raster
B et du raster C : Diachronie avec 4 classes présentant la dynamique forestière*.  
  </figcaption>
</figure>




Selon la configuration des huit valeurs, dix formes peuvent être identifiées.

<figure class="center">
  <img src="figures/geomorphon_10formes.png" width="700">
  <figcaption style="font-size:13px;">*Analyse diachronique de la parcelle 693. A : Orthophotographie actuelle (2016) ; B :
Raster historique : classification pixel forêt / pixel non forêt en 1955 ; C : Raster actuel reclassifié :
classification pixel forêt / pixel non forêt en 2015 ; D : Nouveau raster résultant de la somme du raster
B et du raster C : Diachronie avec 4 classes présentant la dynamique forestière*.  
  </figcaption>
</figure>



# Objectifs et données mobilisées

## Objectifs 

Le paysage est un agencement d’éléments abiotiques, biotiques et anthropiques, permettant le développement d’écosystèmes variés (Reynard, 2005). Il est  possible de cartographier des unités homogènes en classant le terrain en différents éléments du paysages (Evans *et al*., 2009). Etudier les formes du paysage permet alors de mieux comprendre la segmentation paysagère. 

A travers l'algorithme Geomorphon nous cherchons à montrer qu'il est possible d'obtenir rapidement et simplement une description des principaux éléments d'un paysage dans différents contexte de pente. Ainsi, nous présentons la démarche qui permet d'extraire les formes du paysage d'un bassin versant montagneux, d'un bassin versant de moyenne montagne et d'un bassin versant de plaine. 


## Données mobilisées

### RGE MNT 5m

Le calcul des géomorphons se fait à partir d'un modèle numérique de terrain.  Aujourd'hui, les images de très haute résolution sont aujourd’hui en forte croissance et sont disponibles relativement facilement. L'IGN met à notre disposition des MNT de très grande résolution (1m, 5m) sur l'intégralité du territoire français (source). 
Nous travaillons sur des MNT à la résolution de 5m (référence article Géomorphon ?)

Le MNT permet d'extraire de nombreuses informations : l'altitude, la pente, l'orientation. Il permet également de délimiter le réseau hydrographique, mais aussi d'extraire différentes indicateurs topographiques : Topographic Wetness Index, Topographic Position Index, etc. 


### Les bassins versants issus de la BD Topage® de l'IGN-F

Le découpage des bassins versants provient de la BD Topage® (Bassins versant topographiques - BD Topage - Métropole) qui vise à produire un nouveau référentiel hydrographique français, en remplacement du référentiel BD Carthage®. 

Nous travaillons sur trois bassins versants : 
- un bassin versant de haute montagne : Le Ribérot (49 km2)
- un bassin versant de moyenne montagne : L'Allan de la Savoureuse à la Lizaine (248 km2)
- un bassn versant de plaine : L'Yvette de sa source au confluent de la Mérantaise (inclus) (202 km2)

# Méthodologie

## Création du raster virtuel

Il est nécessaire de télécharger le modèle numérique de terrain de chaque département depuis le site de l'IGN-F (https://geoservices.ign.fr/rgealti). Une fois l'ensemble des dalles téléchargées il faut créer un raster virtuel à l'aide du code R suivant :

```
library(terra)
library(stars)
c <- "C:/Users/Downloads/mnt"
v <- "C:/Users/Downloads/new.vrt" 
ras_lst <- list.files(c, full.names = T, pattern = ".asc$", recursive=T)
terra::vrt(ras_lst, v, overwrite = T)
ras <- read_stars(v)
st_crs(ras) = "EPSG:2154"
```


## Découpage du raster par l'emprise d'un bassin versant

L'emprise de chaque bassin versant s'obtient à travers la BD Topage®. Une fois chaque emprise sélectionnée et enregistrée il faut découper le raster virtuel par les limites du bassin versant sur lequel nous souhaitons travailler.

```
bv <- st_read("nom_bassin_versant.gpkg")
mnt <- st_crop(ras,bv)) # ras : nom du raster virtuel
write_stars(mnt,"nom_mnt.tif")
```


## Le traitement Geomorphon : détection des 10 formes du paysage

A partir du MNT de chaque bassin versant, l'algorithme Geomorphon issu de l'algorithme *qgisproces*s nous permet d'obtenir la carte des géomorphons sur chacun des bassins versants. 

```
mnt <- raster("nom_mnt.tif")
dem_geomorphons = qgis_run_algorithm("saga:geomorphons",
                                     DEM = mnt,
                                     THRESHOLD = 1,
                                     RADIUS = 5, # lookup distance/ rayon de recherche
                                     METHOD = 1,
                                     GEOMORPHONS = paste0("geomorphon_nom_bv_5m_LD5", ".tif"))
```

## Statistiques 

```
geomorphon <- raster("geomorphon_nom_bv_5m_LD5.tif")
report_geomorphons = qgis_run_algorithm("native:rasterlayeruniquevaluesreport",
                                    INPUT = geomorphon,
                                    BAND = 1,
                                    OUTPUT_TABLE = paste0("rapport_geomorphon_nom_bv_5m_LD5", ".csv"))
                                    
stat <- read.csv("rapport_geomorphon_nom_bv_5m_LD5.csv")
data.frame(stat)
```

# Résultats

## Résultats sur le bassin versant du Ribérot (milieu de haute montagne)


```{r, echo=FALSE}
library(terra)
library(colourpicker)
r <- rast("data/geomorphon_riberot_5m_LD5.tif")
cuts = c(1,2,3,4,5,6,7,8,9,10,11)
pal <- colorRampPalette(c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"))
terra::plot(r, breaks=cuts, col=pal(10), legend = T)

```





## Résultats sur le bassin versant vosgien (milieu de moyenne montagne)


```{r, echo=FALSE}
library(terra)
library(colourpicker)
r <- rast("data/geomorphon_allan_5m_LD5.tif")
cuts = c(1,2,3,4,5,6,7,8,9,10,11)
pal <- colorRampPalette(c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"))
terra::plot(r, breaks=cuts, col=pal(10), legend = T)

```

## Résultats sur le bassin versant de l'Yvette (milieu de plaine)


```{r, echo=FALSE}
library(terra)
library(colourpicker)
r <- rast("data/geomorphon_yvette_5m_LD5.tif")
cuts = c(1,2,3,4,5,6,7,8,9,10,11)
pal <- colorRampPalette(c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"))
terra::plot(r, breaks=cuts, col=pal(10), legend = T)

```


## Données comparatives sur trois bassins versants représentatifs de trois milieux différentes

Rendu pour les 3 BV : 

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.




# Bibliographie (à revoir)





