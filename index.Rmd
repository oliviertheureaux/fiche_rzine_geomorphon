---
title: "Caractérisation des formes du relief à l'échelle de bassins-versants"
subtitle: "Analyse quantitative des formes du relief via l'algorithme *Geomorphon* pour trois bassins-versants montagnards"
date: "2022-07-5"
author: 
 - name: Olivier Theureaux
   affiliation: UMR LADYSS, CNRS
 - name: Paul Passy
   affiliation: UMR PRODIG, CNRS 
 - name: Thierry Feuillet
   affiliation: UMR LADYSS, CNRS
image: "featured2.png"
output: 
  rzine::readrzine:
    highlight: kate
    number_sections: true
csl: Rzine_citation.csl
bibliography: biblio.bib
nocite : |
  @*
link_citations: true

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Photographie : Pyrénées ariégeoises (cliché D. Birre, 2021)

# Importance du relief dans la compréhension des processus bio-physiques

La caractérisation des formes du relief pour une région donnée est une tâche importante pour la compréhension des processus bio-physiques se produisant sur ce territoire. Tout d'abord, les formes du relief actuelles résultent de processus s'étant déroulés dans le passé sur des échelles spatio-temporelles plus ou moins larges. Des territoires marqués par des épisodes glaciaires, des transgressions marines ou des longues périodes d'aridité présenteront des formes bien caractéristiques. Être capable de les lire nous renseigne immédiatement sur leurs histoires. Par exemple, un territoire sur lequel le géomorphologue identifie la présence de drumlins, est un territoire qui a été englacé dans le passé. Ces formes peuvent également nous renseigner sur les dynamiques présentes. Ainsi, un banc de sable ou de galets au milieu d'une rivière nous indique que ce cours d'eau est sujet à des épisodes de hautes eaux présentant une énergie suffisante pour entraîner des sédimentes plus ou moins gros.

Les formes du relief ont aussi un impact fort sur les processus hydrologiques. L'eau, par définition, suit les plus fortes pentes au sein d'une région donnée. Identifier les formes en creux sur un versant ainsi que leurs pentes nous permettent d'identifier les chemins empruntés par les flux d'eau. Ces chemins, en retour, seront plus sujets à l'érosion hydrique que les régions voisines et pourvoiront les flux d'eau en sédiments et nutriments. Au contraire, les zones de replat ou de cuvettes seront des zones d'étalement et des zones pièges à sédiments et nutriments. La présence d'eau sur des terrains pentus pourra également influer sur les mouvements de terrain comme les éboulements ou les coulées de boues.

La géomorphologie aura également un impact sur le climat local. Les zones de pics ou les lignes de crêtes seront plus sujettes aux vents forts que les bas de versants par exemple. De même, les creux de versants ou les dépressions pourront avoir des températures plus basses que les zones alentours du fait d'une moins forte exposition au Soleil ou au poids plus lourd de l'air froid. Cet impact sur le micro-climat aura, à son tour, des répercussions sur la biodiversité. Certaines espèces se développeront mieux dans les zones ensoleillées que les zones en ombre. D'autres, au contraire, profiteront de la position d'abri qu'offrent les creux de versants.

Enfin, la caractérisation des formes du relief d'un territoire donné aura une importance sur l'aménagement et l'occupation humaine. Certaines installations devront éviter de se trouver sur certaines formes ou à proximité d'autres. Au contraire, d'autres installations pourront profiter de certaines caractéristiques liées à la pente ou à la position d'abri.


# Techniques de caractérisation du relief

## Techniques historiques

Les techniques historiques sont basées sur des calculs géomorphométriques. Différentes caractéristiques (pente, orientation, exposition, profil) sont extraites du modèle numérique de terrain. Ces méthodes de classification automatique du relief sont basées sur la valeur de la pente et de la courbure (convexité) du terrain (Dikau, 1991 ; Wood, 1996). 

Ces méthodes sont efficaces pour traiter de petits rasters. Elles fonctionnent moins bien dans le cadre de rasters à plusieurs millions de pixels : les calculs sont alors trop complexes et demandent trop de ressources pour identifier avec suffisamment de précision l’ensemble des formes du terrain. 


## Techniques par identification de *géomorphons*

L’algorithme ***Geomorphons***, pour *geomorphologic phonotypes*, est une méthode qui identifie les formes du paysage en utilisant un schéma de reconnaissance développé par Jasiewicz et Stepinski (2012). 

L’algorithme des géomorphons permet d’étudier les formes du relief. Nous avons décidé d’utiliser les géomorphons, qui est une méthode relativement récente (2012). Un des premiers usages de l’algorithme fut la création de la carte géomorphologique de la Pologne (Jasiewicz and Stepinski, 2013). Il a été aussi utilisé pour décrire le relief du Monténégro (Frankl *et al*., 2016). Puis l'algorithme a été utilisé pour identifier certaines formes spécifiques du paysage, comme des drumlins (Sarasan *et al*., 2018) ou des surfaces plates (Veselsky *et al*., 2015). Bandura (2016) l’a aussi utilisé pour identifier et délimiter des sommets dans les montagnes slovaques. Cette méthode a également été utilisée pour détecter des objets à une échelle plus fine : des formes à la surface d’un glacier (Gawrysiak, 2020), des traces de barrages organisés par des castors (Swift, 2021), ou bien encore la détection de formes fluviales côtières (Gioia, 2021).

Les géomorphons sont déterminés par une méthode de classification semi-automatique du modèle numérique de terrain (MNT). Cette méthode ne prend pas en compte les valeurs des cellules voisines mais s’inspire du principe de "ligne de mire". La méthode est flexible et s’adapte à différents terrains car le critère de la “ligne de mire” est plus souple que le critère de la “fenêtre fixe” que l’on trouve dans les autres méthodes de classification. Elle adapte la distance à prendre en compte selon la notion de « *terrain openess* ». Il s’agit de calculer le rapport entre ce qui est appelé l’angle au zénith (Φ : *zenith angle*) et l’angle au nadir (Ψ : *nadir angle*) au sein d’un rayon de recherche défini par l’utilisateur (*lookup distance*). Le rayon est égal à x fois la largeur d’un pixel. Par exemple, choisir une *lookup distance* de 10 pour un MNT d’une résolution de 5 mètres cela revient à choisir une *lookup distance* de 50 mètres. Aussi, le paramètre “*threshold angle*” permet de définir le niveau minimum de planéité souhaité permettant de gommer les aspérités microtopographiques. 

Geomorphons compare chaque cellule du MNT aux huit valeurs des voisins visibles les plus lointains. Les altitudes équivalentes à la valeur de la cellule centrale sont représentées par un point vert, celles plus basses en bleu et celles plus hautes en rouge.

<figure class="center">
  <img src="figures/geomorphon_8valeurs.png" width="700">
  <figcaption style="font-size:13px;">*Analyse diachronique de la parcelle 693. A : Orthophotographie actuelle (2016) ; B :
Raster historique : classification pixel forêt / pixel non forêt en 1955 ; C : Raster actuel reclassifié :
classification pixel forêt / pixel non forêt en 2015 ; D : Nouveau raster résultant de la somme du raster
B et du raster C : Diachronie avec 4 classes présentant la dynamique forestière*.  
  </figcaption>
</figure>

Selon la configuration des huit valeurs, dix formes peuvent être identifiées.

<figure class="center">
  <img src="figures/geomorphon_10formes.png" width="700">
  <figcaption style="font-size:13px;">*Analyse diachronique de la parcelle 693. A : Orthophotographie actuelle (2016) ; B :
Raster historique : classification pixel forêt / pixel non forêt en 1955 ; C : Raster actuel reclassifié :
classification pixel forêt / pixel non forêt en 2015 ; D : Nouveau raster résultant de la somme du raster
B et du raster C : Diachronie avec 4 classes présentant la dynamique forestière*.  
  </figcaption>
</figure>


# Objectifs

L'objectif de cette analyse est de quantifier les formes de relief grâce à la technique des géomorphons pour trois bassins-versants montagnards. Les trois bassins choisis sont le Ribérot dans les Pyrénées, la Séveraisse dans les Alpes et la Tarentaine dans le Massif Central.Ces trois bassins sont faiblement anthropisés et présentent des reliefs et des altitudes variées. Pour chacun de ces bassins, la proportion de chaque classe de relief sera calculée. Nous tenterons ainsi de voir si les trois bassins partagent des traits communs et quelles peuvent être les spécificités topographiques de chacun.


# Méthode

Geomorphon est disponible dans les applications SIG GRASS, SAGA et WhiteboxTools. Ici, nous avons décidé de l'utilisé depuis le package QGIS process qui permet facilement d'utiliser des algorithmes du module de traitements QGIS depuis RStudio.

Ainsi, *Geomorphons*, disponible dans l’application SAGA (Système pour les Analyses Géoscientifiques Automatisées) est appelé dans R *via* le package *qgisproceess*.

```
dem_geomorphons = qgis_run_algorithm("saga:geomorphons",
                                       DEM = DEM,
                                       THRESHOLD = 1, # fixe le seuil de planéité
                                       RADIUS = 100, # fixe le rayon de recherche
                                       METHOD = 1, #
                                       GEOMORPHONS = paste("nom", ".tif"))

```


## Données mobilisées

## Les bassins versants issus de la BD Topage® de l'IGN-F

Le découpage des bassins versants provient de la BD Topage® (Bassins versant topographiques - BD Topage - Métropole) qui vise à produire un nouveau référentiel hydrographique français, en remplacement du référentiel BD Carthage®. 

Nous travaillons sur trois bassins versants : 
- un bassin versant pyrénéen : Le Ribérot (49 km2) est situé en Ariège. Il prend sa source au mont Valier (2838m)
- un bassin versant alpin : La Séveraisse du torrent de Navette au Drac (107 km2). Elle prend sa source dans les glaciers des Ecrins. 
- un bassin du Massif Central : La Tarentaine (Trentaine) de sa source au confluent de l'Eau Verte (44 km2). Elle prend sa source à 1785m dans les monts Dore. 


### RGE IGN MNT 5m

Le calcul des géomorphons se fait à partir d'un modèle numérique de terrain.  Aujourd'hui, les images de très haute résolution sont aujourd’hui en forte croissance et sont disponibles relativement facilement. L'IGN met à notre disposition des MNT de très grande résolution (1m, 5m) sur l'intégralité du territoire français (source). 
Nous travaillons sur des MNT à la résolution de 5m (référence article Géomorphon ?)

Le MNT permet d'extraire de nombreuses informations : l'altitude, la pente, l'orientation. Il permet également de délimiter le réseau hydrographique, mais aussi d'extraire différentes indicateurs topographiques : Topographic Wetness Index, Topographic Position Index, etc. 


# Mise en oeuvre

## Préparation des données

### Extraction des bassins de la BD TOPAGE

La librairie sf nous permet d'extraire des bassins versants ciblés par une simple requête sur le nom du BV (TopoOH). 



```
library(sf)

bv <- st_read("BassinVersantTopographique.json")
riberot <- bv %>% filter(bv$TopoOH == "Le Ribérot")
riberot_proj <- st_transform(riberot, 2154)
st_write(riberot_proj, paste0(getwd(), "/", "riberot.shp"))
riberot_shp <- st_read("riberot.shp")
plot(riberot_shp)

```

### Création du raster virtuel de MNT

Il est nécessaire de télécharger le modèle numérique de terrain de chaque département depuis le site de l'IGN-F (https://geoservices.ign.fr/rgealti). Une fois l'ensemble des dalles téléchargées il faut créer un raster virtuel à l'aide du code R suivant :

```
library(terra)
library(stars)
c <- "C:/Users/Downloads/mnt"
v <- "C:/Users/Downloads/new.vrt" 
ras_lst <- list.files(c, full.names = T, pattern = ".asc$", recursive=T)
terra::vrt(ras_lst, v, overwrite = T)
ras <- read_stars(v)
st_crs(ras) = "EPSG:2154"
```


## Découpage du raster par l'emprise d'un bassin versant

L'emprise de chaque bassin versant s'obtient à travers la BD Topage®. Une fois chaque emprise sélectionnée et enregistrée il faut découper le raster virtuel par les limites du bassin versant sur lequel nous souhaitons travailler.

```
bv <- st_read("nom_bassin_versant.shp")
mnt <- st_crop(ras,bv))                     # ras : nom du raster virtuel
write_stars(mnt,"nom_mnt.tif")
mnt <- raster("nom_mnt.tif")
plot(mnt, main="nom du bassin versant")
```

## Le traitement Geomorphon : détection des 10 formes du paysage

A partir du MNT de chaque bassin versant, l'algorithme Geomorphon issu de l'algorithme *qgisprocess* nous permet d'obtenir la carte des géomorphons sur chacun des bassins versants. 

```
mnt <- raster("nom_mnt.tif")
dem_geomorphons = qgis_run_algorithm("saga:geomorphons",
                                     DEM = mnt,
                                     THRESHOLD = 1,
                                     RADIUS = 100, # lookup distance/ rayon de recherche
                                     METHOD = 1,
                                     GEOMORPHONS = paste0("geomorphon_nom_bv_5m_LD5", ".tif"))
```

## Statistiques 

Nous souhaitons présenter le total pour chaque classe de géomorphons pour chaque bassin versant.
Pour ce faire nous utilisons la fonction raster layer unique values report disponible par le package *qgisprocess*.
Cette fonction nous permet d'obtenir le nombre total de pixels pour chaque classe ainsi que la superifice. 

```
geomorphon <- raster("geomorphon_nom_bv_5m_LD5.tif")
report_geomorphons = qgis_run_algorithm("native:rasterlayeruniquevaluesreport",
                                    INPUT = geomorphon,
                                    BAND = 1,
                                    OUTPUT_TABLE = paste0("rapport_geomorphon_nom_bv_5m_LD5", ".csv"))
                                    
stat <- read.csv("rapport_geomorphon_nom_bv_5m_LD5.csv")
data.frame(stat)
```

# Résultats

## Résultats sur le bassin versant du Ribérot (Massif des Pyrénées)


```{r, echo=F, message=F, warning=F}
library(tmap)
library(raster)
library(sp)
r <- raster("data/geomorphon_riberot_5m_LD100.tif")
crs(r) <- "EPSG:2154"
tm_shape(r) + 
  tm_raster(style= "cat",
            labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"),
            palette = c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"),
            title="Géomorphons du Ribérot") + 
  tm_compass(type = "4star", size = 1, position = c("right", "top")) +
  tm_scale_bar(breaks = 1) +
  tm_layout(legend.outside = T)
```




## Résultats sur le bassin alpin

```{r, echo=FALSE, message=F, warning=F}
library(tmap)
library(raster)
library(sp)
r <- raster("data/geomorphon_severaisse_5m_LD100.tif")
crs(r) <- "EPSG:2154"
tm_shape(r) + 
  tm_raster(style= "cat",
            labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"),
            palette = c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"),
            title="Géomorphons de la Séveraisse") + 
  tm_compass(type = "4star", size = 1, position = c("right", "top")) +
  tm_scale_bar(breaks = 1) +
  tm_layout(legend.outside = T)
```


## Résultats sur le bassin versant du Massif Central

```{r, echo=FALSE, message=F, warning=F}
library(tmap)
library(raster)
library(sp)
r <- raster("data/geomorphon_tarentaine_5m_LD100.tif")
crs(r) <- "EPSG:2154"
tm_shape(r) + 
  tm_raster(style= "cat",
            labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"),
            palette = c("#dcdcdc", "#380000", "#c80000", "#ff5014", "#fad23c", "#ffff3c", "#b4e614", "#3cfa96", "#0000ff", "#000038"),
            title="Géomorphons de la Tarentaine") + 
  tm_compass(type = "4star", size = 1, position = c("left", "top")) +
  tm_scale_bar( breaks = 1) +
  tm_layout(legend.outside = T)
```




## Données comparatives sur trois bassins versants représentatifs de trois milieux différents

Statistiques pour le Ribérot : 


```{r, echo=FALSE, warning=  F, message=F}

library(gtsummary)
riberot <- read.csv("rapport_geomorphon_riberot_5m_LD100.csv")
colnames(riberot) <- c("Geomorphon", "Pixel", "Superficie")
riberot$Geomorphon <- as.factor(riberot$Geomorphon)
riberot$Nom <- factor(riberot$Geomorphon, 
                      levels = c("1",  "2",  "3" , "4" , "5"  ,"6" , "7" , "8" , "9"  ,"10"),
                      labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"))

theme_gtsummary_language("fr", decimal.mark = "," , big.mark = " ")
tbl_summary(riberot, 
            label = Pixel ~ "Nombre de pixels",
            include = c("Pixel"), 
            by = Nom, 
            statistic = list(all_continuous() ~ "{sum}")
)
```


Statistiques pour la Séveraisse :


```{r, echo=FALSE, warning=  F, message=F}

library(gtsummary)
riberot <- read.csv("rapport_geomorphon_severaisse_5m_LD100.csv")
colnames(riberot) <- c("Geomorphon", "Pixel", "Superficie")
riberot$Geomorphon <- as.factor(riberot$Geomorphon)
riberot$Nom <- factor(riberot$Geomorphon, 
                      levels = c("1",  "2",  "3" , "4" , "5"  ,"6" , "7" , "8" , "9"  ,"10"),
                      labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"))

theme_gtsummary_language("fr", decimal.mark = "," , big.mark = " ")
tbl_summary(riberot, 
            label = Pixel ~ "Nombre de pixels",
            include = c("Pixel"), 
            by = Nom, 
            statistic = list(all_continuous() ~ "{sum}")
)
```

Statistiques pour la Tarentaine :

```{r, echo=FALSE, warning=  F, message=F}

library(gtsummary)
riberot <- read.csv("rapport_geomorphon_tarentaine_5m_LD100.csv")
colnames(riberot) <- c("Geomorphon", "Pixel", "Superficie")
riberot$Geomorphon <- as.factor(riberot$Geomorphon)
riberot$Nom <- factor(riberot$Geomorphon, 
                      levels = c("1",  "2",  "3" , "4" , "5"  ,"6" , "7" , "8" , "9"  ,"10"),
                      labels = c("Plan", "Sommet", "Crête", "Haut de versant", "Eperon", "Pente", "Creux de versant", "Bas de versant", "Vallée", "Dépression"))

theme_gtsummary_language("fr", decimal.mark = "," , big.mark = " ")
tbl_summary(riberot, 
            label = Pixel ~ "Nombre de pixels",
            include = c("Pixel"), 
            by = Nom, 
            statistic = list(all_continuous() ~ "{sum}")
)
```


Sur ces terrains de montagne, l'objet pente est l'objet le plus représenté par l'algorithme *Geomorphons*. 
Il répésente 69% du total de pixels pour le bassin versant du Ribérot, 70% pour la Séveraisse et 62% pour la Tarentaine. 
Nous tronvons ensuite les objets éperon et creux de versants, chacun représentant pour chaque bassin versant entre 12 et 14% du total. 

# Bibliographie (à revoir)





